<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Production Dashboard | Danyer Acevedo</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      --primary: #3498db;
      --delayed: #e74c3c;
      --in-progress: #f39c12;
      --completed: #2ecc71;
      --pending: #95a5a6;
      --text: #333;
      --text-secondary: #7f8c8d;
      --light-gray: #f5f5f5;
      --bg-color: #f9f9f9;
      --card-bg: #ffffff;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --table-border: #ddd;
    }

    .dark-mode {
      --primary: #2c3e50;
      --delayed: #e74c3c;
      --in-progress: #f39c12;
      --completed: #2ecc71;
      --pending: #bdc3c7;
      --text: #ecf0f1;
      --text-secondary: #bdc3c7;
      --light-gray: #2c3e50;
      --bg-color: #1a1a1a;
      --card-bg: #2c3e50;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      --table-border: #34495e;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      color: var(--text);
      background-color: var(--bg-color);
      transition: background-color 0.3s, color 0.3s;
    }

    .dashboard {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .header-controls {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .header h1 {
      color: var(--primary);
    }

    .last-updated {
      font-size: 0.9em;
      color: var(--text-secondary);
    }

    .dark-mode-toggle {
      background: var(--card-bg);
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: var(--shadow);
    }

    .summary-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
      box-shadow: var(--shadow);
      text-align: center;
    }

    .card h3 {
      margin-top: 0;
      color: var(--text-secondary);
      font-size: 1em;
    }

    .card .number {
      font-size: 2.5em;
      font-weight: bold;
      margin: 10px 0;
    }

    .card.delayed .number {
      color: var(--delayed);
    }

    .card.pending .number {
      color: var(--pending);
    }

    .card.in-progress .number {
      color: var(--in-progress);
    }

    .card.completed .number {
      color: var(--completed);
    }

    .filters {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filters select,
    .filters input {
      padding: 8px 12px;
      border-radius: 4px;
      border: 1px solid var(--table-border);
      background-color: var(--card-bg);
      color: var(--text);
    }

    .export-section {
      margin: 20px 0;
      text-align: right;
    }

    .export-btn {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.3s;
    }

    .export-btn:hover {
      background-color: #2980b9;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      background: var(--card-bg);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    th,
    td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid var(--table-border);
    }

    th {
      background-color: var(--primary);
      color: white;
      cursor: pointer;
    }

    th:hover {
      background-color: #2980b9;
    }

    tr:hover {
      background-color: var(--light-gray);
    }

    .status-delayed {
      color: var(--delayed);
      font-weight: bold;
    }

    .status-pending {
      color: var(--pending);
    }

    .status-in-progress {
      color: var(--in-progress);
    }

    .status-completed {
      color: var(--completed);
    }

    .charts {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    .chart-container {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 8px;
      box-shadow: var(--shadow);
    }

    .chart-container h3 {
      margin-top: 0;
      text-align: center;
      color: var(--text);
    }

    canvas {
      width: 100% !important;
      height: 300px !important;
    }

    .actions {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 8px;
      box-shadow: var(--shadow);
    }

    .actions h3 {
      margin-top: 0;
      color: var(--delayed);
    }

    .action-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid var(--table-border);
    }

    .action-item:last-child {
      border-bottom: none;
    }

    .critical {
      color: var(--delayed);
      font-weight: bold;
    }

    .warning {
      color: var(--in-progress);
    }

    .opportunity {
      color: var(--completed);
    }

    @media (max-width: 768px) {
      .charts {
        grid-template-columns: 1fr;
      }

      .summary-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="dashboard">
    <div class="header">
      <h1>Video Production Dashboard</h1>
      <div class="header-controls">
        <div class="last-updated">Last updated: <span id="current-date"></span></div>
        <button class="dark-mode-toggle" id="dark-mode-toggle">
          üåô Dark Mode
        </button>
      </div>
    </div>

    <div class="summary-cards">
      <div class="card">
        <h3>Total Accounts</h3>
        <div class="number" id="total-accounts">20</div>
      </div>
      <div class="card">
        <h3>Total Videos Required</h3>
        <div class="number" id="total-videos">60</div>
      </div>
      <div class="card pending">
        <h3>Pending Videos</h3>
        <div class="number" id="pending-videos">48</div>
      </div>
      <div class="card in-progress">
        <h3>Under Revision</h3>
        <div class="number" id="under-revision">12</div>
      </div>
    </div>

    <div class="export-section">
      <button id="export-excel" class="export-btn">
        üì• Export to Excel
      </button>
    </div>

    <div class="filters">
      <select id="filter-editor">
        <option value="all">All Editors</option>
        <option value="Ramon">Ramon</option>
        <option value="Duno">Duno</option>
        <option value="Chris">Chris</option>
        <option value="Freddy">Freddy</option>
        <option value="Thais/Maddison">Thais/Maddison</option>
      </select>
      <select id="filter-status">
        <option value="all">All Statuses</option>
        <option value="pending">Pending</option>
        <option value="in-progress">In Progress</option>
        <option value="delayed">Delayed</option>
        <option value="completed">Completed</option>
      </select>
      <input type="text" id="search-account" placeholder="Search account...">
    </div>

    <table id="production-table">
      <thead>
        <tr>
          <th data-sort="account">Account</th>
          <th data-sort="required">Required Videos</th>
          <th data-sort="revision">Under Revision</th>
          <th data-sort="remaining">Remaining</th>
          <th data-sort="editor">Editor</th>
          <th data-sort="status">Status</th>
          <th data-sort="progress">Progress</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>

    <div class="charts">
      <div class="chart-container">
        <h3>Videos by Editor</h3>
        <canvas id="editor-chart"></canvas>
      </div>
      <div class="chart-container">
        <h3>Videos Status</h3>
        <canvas id="status-chart"></canvas>
      </div>
    </div>

    <div class="actions">
      <h3>‚ö†Ô∏è Recommended Actions</h3>
      <div class="action-item critical">
        <span><strong>Global Beauty Solutions</strong>: 2 videos stuck in revision (assign additional resource).</span>
      </div>
      <div class="action-item critical">
        <span><strong>Vegas NJ</strong>: 1 video delayed (follow up with Duno).</span>
      </div>
      <div class="action-item warning">
        <span><strong>Chris</strong>: Handling 7 accounts (bottleneck risk).</span>
      </div>
      <div class="action-item warning">
        <span><strong>Ramon</strong>: 6 accounts with 3 in "Needs Confirmation".</span>
      </div>
      <div class="action-item opportunity">
        <span><strong>East Coast Falcons</strong> and <strong>Frontier Funding</strong>: All videos delivered
          (4/4).</span>
      </div>
    </div>
  </div>

  <script>
    // Production data
    const productionData = [
      { account: "Avalon Medical Group", required: 2, revision: 0, editor: "Ramon" },
      { account: "Caldwell Seafood", required: 3, revision: 1, editor: "Duno" },
      { account: "Coty Marine", required: 4, revision: 0, editor: "Ramon" },
      { account: "Cured & Co.", required: 3, revision: 0, editor: "Ramon" },
      { account: "Cuzzie's Dispensary", required: 4, revision: 0, editor: "Ramon" },
      { account: "East Coast Falcons", required: 4, revision: 0, editor: "Freddy" },
      { account: "Frontier Funding", required: 4, revision: 0, editor: "Chris" },
      { account: "Global Beauty Solutions", required: 2, revision: 2, editor: "Thais/Maddison" },
      { account: "Historic Blue Moon Hotel", required: 3, revision: 0, editor: "Ramon" },
      { account: "Home Concepts by JD", required: 4, revision: 1, editor: "Chris" },
      { account: "J.A.B Enterprises", required: 4, revision: 0, editor: "Freddy" },
      { account: "Jr's Express Car Wash", required: 3, revision: 0, editor: "Duno" },
      { account: "Kaizen Karate USA", required: 3, revision: 0, editor: "Chris" },
      { account: "Napoli Pizza", required: 4, revision: 0, editor: "Chris" },
      { account: "NJ Heart and Vein", required: 3, revision: 0, editor: "Ramon" },
      { account: "NJ Pure", required: 3, revision: 0, editor: "Chris" },
      { account: "Raw Fitness Lodi", required: 3, revision: 0, editor: "Chris" },
      { account: "Sambal Irvington", required: 3, revision: 0, editor: "Duno" },
      { account: "Supreme Deck Store", required: 3, revision: 0, editor: "Ramon" },
      { account: "Talk N Fix Wireless", required: 2, revision: 0, editor: "Thais/Maddison" },
      { account: "Tenafly Oradell Dental Associates", required: 2, revision: 0, editor: "Chris" },
      { account: "The Rugelach Shop", required: 4, revision: 0, editor: "Thais/Maddison" },
      { account: "Vegas NJ", required: 1, revision: 1, editor: "Duno" }
    ];

    // Function to calculate status and progress based on required and revision
    function calculateStatus(item) {
      const remaining = item.required - item.revision;
      let status, progress;

      if (remaining === 0) {
        if (item.revision === 0) {
          status = "completed";
          progress = 100;
        } else {
          status = "completed";
          progress = 100;
        }
      } else if (item.revision > 0) {
        status = "in-progress";
        progress = Math.round((item.revision / item.required) * 100);
      } else {
        status = "pending";
        progress = 0;
      }

      // Special case for items with revision = required but status should be completed
      if (item.revision === item.required && item.required > 0) {
        status = "completed";
        progress = 100;
      }

      return {
        ...item,
        remaining,
        status,
        progress
      };
    }

    // Calculate all statuses initially
    const processedData = productionData.map(calculateStatus);

    // Update current date
    document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });

    // Dark mode toggle
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const body = document.body;

    // Check for saved dark mode preference
    if (localStorage.getItem('dark-mode') === 'enabled') {
      body.classList.add('dark-mode');
      darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
    }

    darkModeToggle.addEventListener('click', () => {
      body.classList.toggle('dark-mode');

      if (body.classList.contains('dark-mode')) {
        darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
        localStorage.setItem('dark-mode', 'enabled');
      } else {
        darkModeToggle.textContent = 'üåô Dark Mode';
        localStorage.setItem('dark-mode', 'disabled');
      }
    });

    // Render table function
    function renderTable(data) {
      const tableBody = document.getElementById('table-body');
      tableBody.innerHTML = '';

      // Calculate status for each item in the current data
      const dataWithStatus = data.map(item => {
        return calculateStatus(item);
      });

      dataWithStatus.forEach(item => {
        const row = document.createElement('tr');
        let statusClass = '';
        if (item.status === 'delayed') statusClass = 'status-delayed';
        else if (item.status === 'in-progress') statusClass = 'status-in-progress';
        else if (item.status === 'pending') statusClass = 'status-pending';
        else statusClass = 'status-completed';

        row.innerHTML = `
          <td>${item.account}</td>
          <td>${item.required}</td>
          <td>${item.revision}</td>
          <td>${item.remaining}</td>
          <td>${item.editor}</td>
          <td class="${statusClass}">
            ${item.status === 'delayed' ? '‚ö†Ô∏è Delayed' :
            item.status === 'in-progress' ? '‚è≥ In Progress' :
              item.status === 'pending' ? '‚è≥ Pending' : '‚úÖ Completed'}
          </td>
          <td>${item.progress}%</td>
        `;
        tableBody.appendChild(row);
      });

      // Update summary metrics
      const totalAccounts = data.length;
      const totalVideos = dataWithStatus.reduce((sum, item) => sum + item.required, 0);
      const underRevision = dataWithStatus.reduce((sum, item) => sum + item.revision, 0);
      const pendingVideos = dataWithStatus.reduce((sum, item) => sum + item.remaining, 0);

      document.getElementById('total-accounts').textContent = totalAccounts;
      document.getElementById('total-videos').textContent = totalVideos;
      document.getElementById('under-revision').textContent = underRevision;
      document.getElementById('pending-videos').textContent = pendingVideos;
    }

    // Filter data function
    function filterData() {
      const editorFilter = document.getElementById('filter-editor').value;
      const statusFilter = document.getElementById('filter-status').value;
      const searchTerm = document.getElementById('search-account').value.toLowerCase();

      let filteredData = processedData.filter(item => {
        if (editorFilter !== 'all' && item.editor !== editorFilter) return false;
        if (statusFilter !== 'all' && item.status !== statusFilter) return false;
        if (searchTerm && !item.account.toLowerCase().includes(searchTerm)) return false;
        return true;
      });

      renderTable(filteredData);
      renderCharts(filteredData);
    }

    // Sort table function
    function sortTable(column) {
      const sortedData = [...processedData].sort((a, b) => {
        if (column === 'account') return a.account.localeCompare(b.account);
        else if (column === 'required') return a.required - b.required;
        else if (column === 'revision') return a.revision - b.revision;
        else if (column === 'remaining') return a.remaining - b.remaining;
        else if (column === 'editor') return a.editor.localeCompare(b.editor);
        else if (column === 'status') return a.status.localeCompare(b.status);
        else return a.progress - b.progress;
      });
      renderTable(sortedData);
    }

    // Set up event listeners
    document.getElementById('filter-editor').addEventListener('change', filterData);
    document.getElementById('filter-status').addEventListener('change', filterData);
    document.getElementById('search-account').addEventListener('input', filterData);

    document.querySelectorAll('th[data-sort]').forEach(th => {
      th.addEventListener('click', () => {
        const column = th.getAttribute('data-sort');
        sortTable(column);
      });
    });

    // Export to Excel function
    document.getElementById('export-excel').addEventListener('click', function () {
      // Get the currently filtered data from the table
      const tableRows = document.querySelectorAll('#table-body tr');
      const excelData = Array.from(tableRows).map(row => {
        const cells = row.querySelectorAll('td');
        return {
          "Account": cells[0].textContent,
          "Required Videos": parseInt(cells[1].textContent),
          "Under Revision": parseInt(cells[2].textContent),
          "Remaining": parseInt(cells[3].textContent),
          "Editor": cells[4].textContent,
          "Status": cells[5].textContent.replace('‚ö†Ô∏è ', '').replace('‚è≥ ', '').replace('‚úÖ ', ''),
          "Progress (%)": parseInt(cells[6].textContent)
        };
      });

      // Create a new workbook
      const workbook = XLSX.utils.book_new();
      const worksheet = XLSX.utils.json_to_sheet(excelData);

      // Add a header row with bold styling
      const headerStyle = { font: { bold: true } };
      const range = XLSX.utils.decode_range(worksheet['!ref']);
      for (let C = range.s.c; C <= range.e.c; ++C) {
        const cell = XLSX.utils.encode_cell({ r: 0, c: C });
        if (!worksheet[cell]) continue;
        worksheet[cell].s = headerStyle;
      }

      // Append the worksheet to the workbook
      XLSX.utils.book_append_sheet(workbook, worksheet, "Video Production");

      // Generate Excel file and trigger download
      const today = new Date();
      const filename = `Video_Production_${today.toISOString().slice(0, 10)}.xlsx`;
      XLSX.writeFile(workbook, filename);
    });

    // Render charts function
    function renderCharts(data) {
      // Calculate status for chart data
      const dataWithStatus = data.map(item => {
        return calculateStatus(item);
      });

      // Editor distribution chart
      const editors = [...new Set(dataWithStatus.map(item => item.editor))];
      const editorCounts = editors.map(editor =>
        dataWithStatus.filter(item => item.editor === editor).length
      );

      // Predefined colors for each editor
      const editorColors = {
        "Ramon": '#3498db',
        "Duno": '#e74c3c',
        "Chris": '#2ecc71',
        "Freddy": '#9b59b6',
        "Thais/Maddison": '#f1c40f'
      };

      const backgroundColors = editors.map(editor => editorColors[editor] || `#${Math.floor(Math.random() * 16777215).toString(16)}`);

      const editorCtx = document.getElementById('editor-chart').getContext('2d');
      if (window.editorChart) window.editorChart.destroy();
      window.editorChart = new Chart(editorCtx, {
        type: 'bar',
        data: {
          labels: editors,
          datasets: [{
            label: 'Accounts per Editor',
            data: editorCounts,
            backgroundColor: backgroundColors,
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: { y: { beginAtZero: true } },
          plugins: {
            legend: { display: false }
          }
        }
      });

      // Status distribution chart
      const statusCounts = {
        pending: dataWithStatus.filter(item => item.status === 'pending').length,
        inProgress: dataWithStatus.filter(item => item.status === 'in-progress').length,
        delayed: dataWithStatus.filter(item => item.status === 'delayed').length,
        completed: dataWithStatus.filter(item => item.status === 'completed').length
      };

      const statusCtx = document.getElementById('status-chart').getContext('2d');
      if (window.statusChart) window.statusChart.destroy();
      window.statusChart = new Chart(statusCtx, {
        type: 'doughnut',
        data: {
          labels: ['Pending', 'In Progress', 'Delayed', 'Completed'],
          datasets: [{
            data: [
              statusCounts.pending,
              statusCounts.inProgress,
              statusCounts.delayed,
              statusCounts.completed
            ],
            backgroundColor: [
              '#95a5a6',
              '#f39c12',
              '#e74c3c',
              '#2ecc71'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'right' }
          }
        }
      });
    }

    // Initial load
    renderTable(productionData);
    renderCharts(productionData);
  </script>
</body>

</html>